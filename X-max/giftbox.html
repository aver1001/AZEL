<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZEL Gift Box</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@400;600&family=Noto+Sans+KR:wght@300;400;500&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(180deg, #1a0a0a 0%, #2d1515 50%, #1a0a0a 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            color: #fff;
        }

        /* ============ VIDEO (Full Screen) ============ */
        .giftbox-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
        }

        /* ============ BOX SELECTION SCREEN ============ */
        .box-selection-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: url('boxBackGround.png') center center / cover no-repeat;
            z-index: 10;
            padding: 20px;
        }

        .box-selection-screen.hidden {
            display: none;
        }

        .selection-title {
            font-family: 'Great Vibes', cursive;
            font-size: 2rem;
            color: #ffd700;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5),
                0 2px 4px rgba(0, 0, 0, 0.9),
                0 4px 8px rgba(0, 0, 0, 0.7);
            margin-bottom: 30px;
        }

        .box-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            max-width: 350px;
            overflow: visible;
        }

        .box-item {
            cursor: pointer;
            transition: transform 1.2s ease-out, opacity 1.2s ease-out;
            position: relative;
        }

        /* ÏÑ†ÌÉù ÏïàÎêú Î∞ïÏä§Îäî fade out */
        .box-item.fade-out {
            animation: fadeOut 0.5s ease-out forwards !important;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: scale(0.8);
            }
        }

        .box-item.selected {
            animation: none !important;
            z-index: 100;
        }

        /* ============ ÏÑ†ÌÉùÎêú Î∞ïÏä§ ÏµúÏ¢Ö ÏúÑÏπò/ÌÅ¨Í∏∞ (ÏòÅÏÉÅÍ≥º ÎßûÏ∂îÍ∏∞ ÏúÑÌïú Î≥ÄÏàò) ============ */
        :root {
            /* Î∞ïÏä§ ÏµúÏ¢Ö ÏúÑÏπò (ÌôîÎ©¥ Í∏∞Ï§Ä %) */
            --box-final-top: 67.4%;
            /* ÏÑ∏Î°ú ÏúÑÏπò: Îçî ÏïÑÎûòÎ°ú */
            --box-final-left: 50%;
            /* Í∞ÄÎ°ú ÏúÑÏπò: Ï§ëÏïô */
            /* Î∞ïÏä§ ÏµúÏ¢Ö ÌÅ¨Í∏∞ Î∞∞Ïú® */
            --box-final-scale: 2.77;
            /* 1.8Î∞∞ ÌÅ¨Í≤å */
        }

        .box-item.selected.centered {
            position: fixed !important;
            top: var(--box-final-top) !important;
            left: var(--box-final-left) !important;
            transform: translate(-50%, -50%) scale(var(--box-final-scale)) !important;
            transition: all 0.6s ease-out;
        }

        .box-item:nth-child(1) {
            animation: wiggle1 3s ease-in-out infinite;
        }

        .box-item:nth-child(2) {
            animation: wiggle2 3.2s ease-in-out infinite;
        }

        .box-item:nth-child(3) {
            animation: wiggle3 2.8s ease-in-out infinite;
        }

        .box-item:nth-child(4) {
            animation: wiggle2 3.1s ease-in-out infinite;
        }

        .box-item:nth-child(5) {
            animation: wiggle1 2.9s ease-in-out infinite;
        }

        .box-item:nth-child(6) {
            animation: wiggle3 3.3s ease-in-out infinite;
        }

        .box-item:nth-child(7) {
            animation: wiggle1 3.0s ease-in-out infinite;
        }

        .box-item:nth-child(8) {
            animation: wiggle2 2.7s ease-in-out infinite;
        }

        .box-item:nth-child(9) {
            animation: wiggle3 3.4s ease-in-out infinite;
        }

        .box-item:active {
            transform: scale(0.95);
        }

        .box-image {
            width: 100%;
            height: auto;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.5));
        }

        @keyframes wiggle1 {

            0%,
            100% {
                transform: rotate(0deg) translateY(0);
            }

            25% {
                transform: rotate(-2deg) translateY(-3px);
            }

            75% {
                transform: rotate(2deg) translateY(3px);
            }
        }

        @keyframes wiggle2 {

            0%,
            100% {
                transform: rotate(0deg) translateY(0);
            }

            25% {
                transform: rotate(2deg) translateY(3px);
            }

            75% {
                transform: rotate(-2deg) translateY(-3px);
            }
        }

        @keyframes wiggle3 {

            0%,
            100% {
                transform: rotate(0deg) translateX(0);
            }

            25% {
                transform: rotate(-1deg) translateX(-3px);
            }

            75% {
                transform: rotate(1deg) translateX(3px);
            }
        }

        .selection-hint {
            margin-top: 30px;
            font-size: 1rem;
            color: #ffffff;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.9),
                0 4px 8px rgba(0, 0, 0, 0.7);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 0.6;
            }

            50% {
                opacity: 1;
            }
        }

        /* ============ PRIZE SCREEN ============ */
        .prize-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 30px;
            z-index: 101;
            padding: 20px;
        }

        .prize-screen.active {
            display: flex;
        }

        .white-to-red-overlay {
            display: none;
        }

        @keyframes whiteToTransparent {
            0% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        @keyframes fogFade {
            0% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        .prize-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 1.2rem;
            font-weight: bold;
            color: #000000;
            z-index: 6;
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        @keyframes gentleFadeIn {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        .prize-image-container {
            position: relative;
            z-index: 6;
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        .prize-emoji {
            font-size: 120px;
            filter: drop-shadow(0 20px 50px rgba(255, 215, 0, 0.3));
        }

        .prize-name {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: #fff;
            letter-spacing: 3px;
            text-align: center;
            z-index: 6;
        }

        .prize-description {
            font-size: 1rem;
            font-weight: bold;
            color: #000000;
            text-align: center;
            max-width: 300px;
            line-height: 1.6;
            z-index: 6;
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) 0.2s forwards;
            opacity: 0;
        }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Sparkle effect */
        .sparkle-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 400px;
            pointer-events: none;
        }

        .sparkle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ffd700;
            border-radius: 50%;
            animation: sparkle 2s ease-in-out infinite;
        }

        @keyframes sparkle {

            0%,
            100% {
                opacity: 0;
                transform: scale(0);
            }

            50% {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>

<body>
    <!-- Video (always visible, paused initially) -->
    <video class="giftbox-video" id="giftboxVideo" playsinline>
        <source src="gacha.mp4" type="video/mp4">
    </video>

    <!-- Box Selection Screen -->
    <div class="box-selection-screen" id="boxSelectionScreen">
        <h1 class="selection-title">Choose Your Gift</h1>
        <div class="box-grid">
            <div class="box-item" onclick="selectBox(1)">
                <img src="box.png" alt="Box 1" class="box-image">
            </div>
            <div class="box-item" onclick="selectBox(2)">
                <img src="box.png" alt="Box 2" class="box-image">
            </div>
            <div class="box-item" onclick="selectBox(3)">
                <img src="box.png" alt="Box 3" class="box-image">
            </div>
            <div class="box-item" onclick="selectBox(4)">
                <img src="box.png" alt="Box 4" class="box-image">
            </div>
            <div class="box-item" onclick="selectBox(5)">
                <img src="box.png" alt="Box 5" class="box-image">
            </div>
            <div class="box-item" onclick="selectBox(6)">
                <img src="box.png" alt="Box 6" class="box-image">
            </div>
            <div class="box-item" onclick="selectBox(7)">
                <img src="box.png" alt="Box 7" class="box-image">
            </div>
            <div class="box-item" onclick="selectBox(8)">
                <img src="box.png" alt="Box 8" class="box-image">
            </div>
            <div class="box-item" onclick="selectBox(9)">
                <img src="box.png" alt="Box 9" class="box-image">
            </div>
        </div>
        <p class="selection-hint">ÏÑ†Î¨º ÏÉÅÏûêÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî!</p>
    </div>

    <!-- Prize Screen -->
    <div class="prize-screen" id="prizeScreen">
        <div class="white-to-red-overlay"></div>
        <p class="prize-title">AZEL 1Ï£ºÎÖÑ Í∏∞ÎÖê Í∏∞ÌîÑÌä∏</p>
        <div class="prize-image-container">
            <div class="sparkle-container" id="sparkleContainer"></div>
            <span class="prize-emoji">üéÅ</span>
        </div>
        <p class="prize-description" id="prizeDescription">AZEL 1Ï£ºÎÖÑ Í∏∞ÎÖê Ïä§ÌéòÏÖú Í∏∞ÌîÑÌä∏Î•º<br>Î∞õÏúºÏÖ®ÏäµÎãàÎã§!</p>
    </div>

    <script>
        // Create sparkles
        function createSparkles() {
            const container = document.getElementById('sparkleContainer');
            for (let i = 0; i < 20; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                sparkle.style.animationDuration = (Math.random() * 1 + 1.5) + 's';
                container.appendChild(sparkle);
            }
        }

        // Select a gift box
        function selectBox(boxNumber) {
            const boxes = document.querySelectorAll('.box-item');
            const selectedBox = boxes[boxNumber - 1];
            const video = document.getElementById('giftboxVideo');
            const boxSelectionScreen = document.getElementById('boxSelectionScreen');

            // ÏÑ†ÌÉùÌïú Î∞ïÏä§ ÏúÑÏπò Ï†ÄÏû•
            const rect = selectedBox.getBoundingClientRect();

            // ÏÑ†ÌÉùÌïú Î∞ïÏä§ wiggle Î©àÏ∂§
            selectedBox.classList.add('selected');

            // Îã§Î•∏ Î∞ïÏä§Îì§ÏùÄ fade out
            boxes.forEach((box, index) => {
                if (index + 1 !== boxNumber) {
                    box.classList.add('fade-out');
                }
            });

            // 0.3Ï¥à ÌõÑ: ÏÑ†ÌÉùÌïú Î∞ïÏä§Î•º Î™©Ìëú ÏúÑÏπòÎ°ú Ïù¥Îèô (Îçî ÏïÑÎûò, Îçî ÌÅ¨Í≤å)
            setTimeout(() => {
                // ============ ÏòÅÏÉÅ ÏÜç Î∞ïÏä§ ÏÑ§Ï†ï (ÏòÅÏÉÅ ÏõêÎ≥∏ Í∏∞Ï§Ä) ============
                const videoBoxX = 0.5;      // Í∞ÄÎ°ú 50% (Ï§ëÏïô)
                const videoBoxY = 0.67;    // ÏÑ∏Î°ú 67.4%
                const baseScale = 1.44;     // Í∏∞Ï§Ä Ìï¥ÏÉÅÎèÑ(ÌòÑÏû¨ ÌÖåÏä§Ìä∏ Í∏∞Í∏∞)ÏóêÏÑúÏùò Ïä§ÏºÄÏùº

                // ÏòÅÏÉÅ ÏõêÎ≥∏ ÎπÑÏú® (ÏÑ∏Î°ú ÏòÅÏÉÅ Í∏∞Ï§Ä)
                const videoWidth = video.videoWidth || 1080;
                const videoHeight = video.videoHeight || 1920;
                const videoRatio = videoWidth / videoHeight;

                // ÌôîÎ©¥ ÎπÑÏú®
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                const screenRatio = screenWidth / screenHeight;

                // object-fit: cover Í≥ÑÏÇ∞
                let displayWidth, displayHeight, offsetX, offsetY;

                if (screenRatio > videoRatio) {
                    // ÌôîÎ©¥Ïù¥ Îçî ÎÑìÏùå ‚Üí ÏòÅÏÉÅÏùò ÏúÑÏïÑÎûòÍ∞Ä ÏûòÎ¶º
                    displayWidth = screenWidth;
                    displayHeight = screenWidth / videoRatio;
                    offsetX = 0;
                    offsetY = (screenHeight - displayHeight) / 2;
                } else {
                    // ÌôîÎ©¥Ïù¥ Îçî Ï¢ÅÏùå ‚Üí ÏòÅÏÉÅÏùò Ï¢åÏö∞Í∞Ä ÏûòÎ¶º
                    displayHeight = screenHeight;
                    displayWidth = screenHeight * videoRatio;
                    offsetX = (screenWidth - displayWidth) / 2;
                    offsetY = 0;
                }

                // ÏòÅÏÉÅ ÌôïÎåÄ ÎπÑÏú® Í≥ÑÏÇ∞ (ÏòÅÏÉÅÏù¥ ÌôîÎ©¥ÏóêÏÑú ÏñºÎßàÎÇò ÌôïÎåÄÎêòÏóàÎäîÏßÄ)
                const videoScaleRatio = displayWidth / videoWidth;

                // Î∞ïÏä§ ÌÅ¨Í∏∞ÎèÑ ÏòÅÏÉÅ ÌôïÎåÄ ÎπÑÏú®Ïóê ÎßûÏ∂∞ Ï°∞Ï†ï
                const targetScale = baseScale * (videoScaleRatio / (screenWidth / 1080));

                // ÏòÅÏÉÅ ÏÜç Î∞ïÏä§ ÏúÑÏπòÎ•º ÌôîÎ©¥ ÏúÑÏπòÎ°ú Î≥ÄÌôò
                const centerX = offsetX + displayWidth * videoBoxX - rect.width / 2;
                const centerY = offsetY + displayHeight * videoBoxY - rect.height / 2;
                const moveX = centerX - rect.left;
                const moveY = centerY - rect.top;

                selectedBox.style.transition = 'transform 1.2s ease-in-out';
                selectedBox.style.transform = `translate(${moveX}px, ${moveY}px) scale(${targetScale})`;
            }, 300);

            // 1.5Ï¥à ÌõÑ: ÏòÅÏÉÅ ÏãúÏûë
            setTimeout(() => {
                boxSelectionScreen.classList.add('hidden');
                video.play();
                // ÏòÅÏÉÅ ÏãúÏûë 8Ï¥à ÌõÑ ÏÉÅÌíà ÌëúÏãú
                setTimeout(showPrize, 8000);
            }, 1500);
        }

        // Show prize screen
        function showPrize() {
            const prizeScreen = document.getElementById('prizeScreen');

            // Show prize
            prizeScreen.classList.add('active');

            // Create sparkles
            createSparkles();
        }

        // Optional: Set prize info dynamically
        function setPrize(imageSrc, name, description) {
            document.getElementById('prizeImage').src = imageSrc;
            document.getElementById('prizeName').textContent = name;
            document.getElementById('prizeDescription').textContent = description;
        }
    </script>
</body>

</html>